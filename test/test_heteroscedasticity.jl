
@testset "White's covariance estimators" begin
    # using data from Nerlove Cobb-Douglas model from https://github.com/mcreel/Econometrics/blob/master/Examples/Data/nerlove.csv
    cost = [0.082, 0.661, 0.99, 0.315, 0.197, 0.098, 0.949, 0.675, 0.525, 0.501, 1.194, 0.67, 0.349, 0.423, 0.501, 0.55, 0.795, 0.664, 0.705, 0.903, 1.504, 1.615, 1.127, 0.718, 2.414, 1.13, 0.992, 1.554, 1.225, 1.565, 1.936, 3.154, 2.599, 3.298, 2.441, 2.031, 4.666, 1.834, 2.072, 2.039, 3.398, 3.083, 2.344, 2.382, 2.657, 1.705, 3.23, 5.049, 3.814, 4.58, 4.358, 4.714, 4.357, 3.919, 3.442, 4.898, 3.584, 5.535, 4.406, 4.289, 6.731, 6.895, 5.112, 5.141, 5.72, 4.691, 6.832, 4.813, 6.754, 5.127, 6.388, 4.509, 7.185, 6.8, 7.743, 7.968, 8.858, 8.588, 6.449, 8.488, 8.877, 10.274, 6.024, 8.258, 13.376, 10.69, 8.308, 6.082, 9.284, 10.879, 8.477, 6.877, 15.106, 8.031, 8.082, 10.866, 8.596, 8.673, 15.437, 8.211, 11.982, 16.674, 12.62, 12.905, 11.615, 9.321, 12.962, 16.932, 9.648, 18.35, 17.333, 12.015, 11.32, 22.337, 19.035, 12.205, 17.078, 25.528, 24.021, 32.197, 26.652, 20.164, 14.132, 21.41, 23.244, 29.845, 32.318, 21.988, 35.229, 17.467, 22.828, 33.154, 32.228, 34.168, 40.594, 33.354, 64.542, 41.238, 47.993, 69.878, 44.894, 67.12, 73.05, 139.422, 119.939]
    output = [2, 3, 4, 4, 5, 9, 11, 13, 13, 22, 25, 25, 35, 39, 43, 63, 68, 81, 84, 73, 99, 101, 119, 120, 122, 130, 138, 149, 196, 197, 209, 214, 220, 234, 235, 253, 279, 290, 290, 295, 299, 324, 333, 338, 353, 353, 416, 420, 456, 484, 516, 550, 563, 566, 592, 671, 696, 719, 742, 795, 800, 808, 811, 855, 860, 909, 913, 924, 984, 991, 1000, 1098, 1109, 1118, 1122, 1137, 1156, 1166, 1170, 1215, 1279, 1291, 1290, 1331, 1373, 1420, 1474, 1497, 1545, 1649, 1668, 1782, 1831, 1833, 1838, 1787, 1918, 1930, 2028, 2057, 2084, 2226, 2304, 2341, 2353, 2367, 2451, 2457, 2507, 2530, 2576, 2607, 2870, 2993, 3202, 3286, 3312, 3498, 3538, 3794, 3841, 4014, 4217, 4305, 4494, 4764, 5277, 5283, 5668, 5681, 5819, 6000, 6119, 6136, 7193, 7886, 8419, 8642, 8787, 9484, 9956, 11477, 11796, 14359, 16719]
    labor = [2.09, 2.05, 2.05, 1.83, 2.12, 2.12, 1.98, 2.05, 2.19, 1.72, 2.09, 1.68, 1.81, 2.3, 1.75, 1.76, 1.98, 2.29, 2.19, 1.75, 2.2, 1.66, 1.92, 1.77, 2.09, 1.82, 1.8, 1.92, 1.92, 2.19, 1.92, 1.52, 1.92, 2.2, 2.11, 1.92, 2.05, 1.66, 1.8, 1.77, 1.7, 2.05, 2.19, 1.85, 2.19, 2.13, 1.54, 1.52, 2.09, 1.75, 2.3, 2.05, 2.32, 2.31, 1.92, 2.05, 1.76, 1.7, 2.04, 2.24, 1.7, 1.68, 2.29, 2.0, 2.31, 1.45, 1.7, 1.76, 1.7, 2.09, 1.55, 2.11, 2.05, 2.3, 2.19, 2.04, 2.31, 1.7, 2.05, 2.19, 2.0, 2.32, 1.55, 2.13, 2.2, 2.2, 1.85, 1.76, 1.8, 2.32, 1.8, 2.13, 1.98, 1.76, 1.45, 2.24, 1.69, 1.81, 2.11, 1.76, 1.77, 2.0, 2.3, 2.04, 1.69, 1.76, 2.04, 2.2, 1.76, 2.31, 1.92, 1.76, 1.76, 2.31, 2.3, 1.61, 1.68, 2.09, 2.09, 2.05, 2.29, 2.11, 1.53, 2.11, 2.04, 2.19, 1.92, 2.04, 2.11, 1.76, 1.79, 2.11, 1.54, 1.92, 2.12, 1.61, 2.32, 2.24, 2.31, 2.11, 1.68, 2.24, 2.12, 2.31, 2.3]
    fuel = [17.9, 35.1, 35.1, 32.2, 28.6, 28.6, 35.5, 35.1, 29.1, 15.0, 17.9, 39.7, 22.6, 23.6, 42.8, 10.3, 35.5, 28.5, 29.1, 42.8, 36.2, 33.4, 22.5, 21.3, 17.9, 38.9, 20.2, 22.5, 29.1, 29.1, 22.5, 27.5, 22.5, 36.2, 24.4, 22.5, 35.1, 33.4, 20.2, 21.3, 26.9, 35.1, 29.1, 24.6, 29.1, 10.7, 26.2, 27.5, 30.0, 42.8, 23.6, 35.1, 31.9, 33.5, 22.5, 35.1, 10.3, 26.9, 20.7, 26.5, 26.9, 39.7, 28.5, 34.3, 33.5, 17.6, 26.9, 10.3, 26.9, 30.0, 28.2, 24.4, 35.1, 23.6, 29.1, 20.7, 33.5, 26.9, 35.1, 29.1, 34.3, 31.9, 28.2, 30.0, 36.2, 36.2, 24.6, 10.3, 20.2, 31.9, 20.2, 10.7, 35.5, 10.3, 17.6, 26.5, 12.9, 22.6, 24.4, 10.3, 21.3, 34.3, 23.6, 20.7, 12.9, 10.3, 20.7, 36.2, 10.3, 33.5, 22.5, 10.3, 10.3, 33.5, 23.6, 17.8, 28.8, 30.0, 30.0, 35.1, 28.5, 24.4, 18.1, 24.4, 20.7, 29.1, 29.1, 20.7, 24.4, 10.3, 18.5, 24.4, 26.2, 22.5, 28.6, 17.8, 31.9, 26.5, 33.5, 24.4, 28.8, 26.5, 28.6, 33.5, 23.6]
    capital = [183, 174, 171, 166, 233, 195, 206, 150, 155, 188, 170, 167, 213, 164, 170, 161, 210, 158, 156, 176, 170, 192, 164, 175, 180, 176, 202, 227, 186, 183, 169, 168, 164, 164, 170, 158, 177, 195, 176, 188, 187, 152, 157, 163, 143, 167, 217, 144, 178, 176, 167, 158, 162, 198, 164, 164, 161, 174, 157, 185, 157, 203, 178, 183, 168, 196, 166, 172, 158, 174, 225, 168, 177, 161, 162, 158, 176, 183, 166, 164, 207, 175, 225, 178, 157, 138, 163, 168, 158, 177, 170, 183, 162, 177, 196, 164, 158, 157, 163, 161, 156, 217, 161, 183, 167, 161, 163, 170, 174, 197, 162, 155, 167, 176, 170, 183, 190, 170, 176, 159, 157, 161, 172, 203, 167, 195, 161, 159, 177, 157, 196, 183, 189, 160, 162, 178, 199, 182, 190, 165, 203, 151, 148, 212, 162]
    ndf = DataFrame(cost = cost, output = output, labor = labor, fuel = fuel, capital = capital)

    f = @formula(log(cost) ~ 1 + log(output) + log(labor) + log(fuel) + log(capital))
    lr2 = regress(f, ndf, cov=[:hc0, :nw])

    @test isapprox([1.6887096637865764, 0.03203057017940859, 0.2413635423569017, 0.07416986820706634, 0.3181801843194431], lr2.white_stderrors)
    @test isapprox([-2.088282503859893, 22.490828975090466, 1.807817355217008, 5.750542145660426, -0.6910812225036552], lr2.white_t_values)
    @test isapprox([0.03858351163194079, 2.515671235586196e-48, 0.07278163877804528, 5.358556751845478e-8, 0.4906588080040115], lr2.white_p_values)
    @test isapprox([1.5413337169817793, 0.04558343812215214, 0.250278670841928, 0.07289639728036612, 0.2651138982712092], lr2.nw_stderrors)
    @test isapprox([-2.287955428555851, 15.803855644877787, 1.7434214402754615, 5.851001818682364, -0.8294108765696443], lr2.nw_t_values)
    @test isapprox([0.02363824106367065, 6.252423796307023e-33, 0.08345530926614206, 3.306228013288088e-8, 0.4082838999795607], lr2.nw_p_values)

end
